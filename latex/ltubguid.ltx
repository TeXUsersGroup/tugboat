% $Id$
% ltubguid.ltx - documentation for ltugboat classes.
% 
% Copyright 1994-2023 TeX Users Group.
% 
% This file is part of the tugboat package.
% 
% This work may be distributed and/or modified under the
% conditions of the LaTeX Project Public License, either version 1.3
% of this license or (at your option) any later version.
% The latest version of this license is in
%   http://www.latex-project.org/lppl.txt
% and version 1.3 or later is part of all distributions of LaTeX
% version 2003/12/01 or later.
%
% This work has the LPPL maintenance status "maintained".
% 
% The Current Maintainer of this work is the TeX Users Group
% (https://tug.org/TUGboat).
%
% The list of all files belonging to the distribution is
% given in the file `manifest.txt'. 
%
% The list of derived (unpacked) files belonging to the distribution 
% and covered by LPPL is defined by the unpacking scripts (with 
% extension .ins) which are part of the distribution.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  tubguide.bib -- the bibliography for this paper (apart from the
%  references to TUGboat itself)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
\begin{filecontents}{tubguide.bib}
% BibTeX bibliography file (originally generated by aux2bib)

@Misc{pkg:fancyvrb,
  author = {Timothy Van Zandt and others},
  title = {The {\tbcode{fancyvrb}} package},
  url = {ctan.org/pkg/fancyvrb},
}

@Misc{pkg:listings,
  author = {Carsten Heinz and others},
  title = {The {\tbcode{listings}} package},
  url = {ctan.org/pkg/listings},
}

@Misc{Arseneau:url:1996,
  author = {Donald Arseneau},
  title = {The {\tbcode{url}} package},
  url = {ctan.org/pkg/url},
  urlnewline = 1,
}

@Misc{Rahtz:hyperref:1997,
  author = {Sebastian Rahtz and Heiko Oberdiek and others},
  title = {The {\tbcode{hyperref}} package},
  url = {ctan.org/pkg/hyperref},
}

@Book{Lamport:1994,
  author = {Leslie Lamport},
  title = {{\LaTeX}: A Document Preparation System},
  edition = {\nth{2}},
  year = {1994},
  publisher = {Addison-Wesley},
}

@Misc{Schoepf:verbatim:1996,
  author = {Rainer Sch{\"{o}}pf},
  title = {The {\tbcode{verbatim}} package},
  url = {ctan.org/pkg/verbatim},
  urlnewline = 1,
}

@Misc{Vieth:mflogo:1995,
  author = {Ulrik Vieth},
  title = {The {\tbcode{mflogo}} package},
  url = {ctan.org/pkg/mflogo},
  urlnewline = 1,
}

@Article{Whitney:TB10-3-378,
  author = {Ron Whitney and Barbara Beeton},
  title = {{{{\TUB} authors' guide}}},
  journal = {{\TUB}},
  year = {1989},
  month = {November},
  volume = {10},
  number = {3},
  pages = {378--385},
  url = {ctan.org/pkg/tugboat-plain},
}

\end{filecontents}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% ctandir.sty -- an experimental style file to go with Donald
% Arseneau's url.sty. Not recommended these days, better to use
% https://ctan.org/pkg/..., but don't feel like rewriting.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
\begin{filecontents}{ctandir.sty}
%
% Experimental CTAN location information macros for use with Donald
% Arseneau's |url.sty|
%
% we need url.sty; we can rely on it to demand anything it needs of
% LaTeX. Not 
\IfFileExists{url.sty}%
  {\RequirePackage{url}}%
  {\PackageWarning{ctandir}{You should acquire a copy of url.sty}%
   \newcommand\urldef[3]{\def#1{\texttt{#3}}}%
   \let\url\texttt
  }
%
\newcommand\CTANdirectory[1]{\expandafter\urldef
  \csname CTAN@#1\endcsname\path}
\newcommand\CTANfile[1]{\expandafter\urldef
  \csname CTAN@#1\endcsname\path}
%
% Use the standard label-referencing mechanism to get the warning for
% an undefined label
\newcommand\CTANref[1]{\expandafter\@setref\csname CTAN@#1\endcsname
  \relax{#1}}
\end{filecontents}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
\documentclass[letterpaper]{ltugboat}
\usepackage{graphics} % so letterpaper takes effect
\usepackage{microtype}
\usepackage{ctandir}
\usepackage[hidelinks,pdfa]{hyperref}
\IfFileExists{booktabs.sty}%
  {\usepackage{booktabs}}%
  {\let\midrule\hline}
%
\vbadness=10000   % imperfectly broken pages are ok
\overfullrule=4pt % want to see
% omit word "draft:"
\def\rtitlenexttopage{\ifPrelimDraft \textsl{\small \Now}\fi}
%
% define CTAN addresses using the commands of the |ctandir| package
\CTANdirectory{packages}{macros/latex/required}
\CTANdirectory{tub-latex}{macros/latex/contrib/tugboat}
%
% ***** Commands provided by this paper *****
%
% Typeset the name of an environment, class, package, option, program
\providecommand\envname[1]{\tbcode{#1}}
\providecommand\clsname[1]{\tbcode{#1}}
\providecommand\pkgname[1]{\tbcode{#1}}
\providecommand\optname[1]{\tbcode{#1}}
\providecommand\progname[1]{\tbcode{#1}}
%
% A list of options for a package/class
\newenvironment{optlist}{\begin{description}%
   \renewcommand\makelabel[1]{%
     \descriptionlabel{\mdseries\optname{##1}}}%
   \itemsep0.25\itemsep}%
  {\end{description}}
%
% A list of command names (using \mdwcmd, which as its name implies
% comes from the work of Mark Wooding)
\newenvironment{cmdlist}{\begin{description}%
   \renewcommand\makelabel[1]{%
     \descriptionlabel{\mdseries\mdwcmd##1}}%
   \itemsep0.25\itemsep}%
  {\end{description}}
%
\makeatletter
\providecommand{\mdwcmd}[1]{%
  \expandafter\texttt\expandafter{\string#1}%
  \mdwcmd@i}
\def\mdwcmd@i{\futurelet\@let@token\mdwcmd@ii}
\def\mdwcmd@ii{%
  \let\@tempa\relax%
  \ifx\@let@token\bgroup%
    \def\@tempa##1{\texttt{\char`\{}\textit{##1}\texttt{\char`\}}\mdwcmd@i}%
  \fi%
  \ifx\@let@token[%
    \def\@tempa[##1]{\texttt{[}\textit{##1}\texttt{]}\mdwcmd@i}%
  \fi%
  \@tempa%
}
\makeatother
\def\url{\tburl} % use our url macros
%
%%%%%%%%%%%%%%%%
\begin{document}
%%%%%%%%%%%%%%%%
%
\title{The \LaTeXe\ \TUB{} macros}
\author{TUGboat editors}
\EDITORnoaddress
\netaddress{tugboat@tug.org}
\personalURL{tug.org/TUGboat}
\maketitle
{\hyphenpenalty=10000\raggedright \tableofcontents}
\count0=1

\section{Introduction}

This is the documentation for the \LaTeXe\ macros to be used by \TUB{}
authors. The macros represent a development of the earlier
\clsname{ltugboat} and \clsname{ltugproc} styles that were written for
use with \LaTeX~2.09; the main original author was Robin Fairbairns,
with Sebastian Rahtz, Michel Goossens, Nico Poppelier and Johannes
Braams. Many others have been involved in the years since, including
Barbara Beeton, Karl Berry, Mimi Burbank, and the \LaTeX\ team.

\subsection{Availability}

The \TUB\ web pages are at:\par\smallskip
\centerline{\url{https://tug.org/TUGboat}}
\par\smallskip\noindent
They provide \textbf{an article template}, information for authors and
reviewers, and the complete run of all published \TUB\ issues, among
other things.

The macros are distributed via \CTAN{}
(\url{https://ctan.org/pkg/tugboat}) in the usual \LaTeX{} way as files
\path|tugboat.dtx| and \path|tugboat.ins|. When the \verb|.ins| file is
processed by \LaTeX{}, the files \path|ltugboat.cls| and
\path|ltugcomn.sty| (a melange of perhaps-useful macros, for
documentation, etc.)\ are produced. (For compatibility,
\path|ltugproc.cls| is also produced, but is no longer used for
proceedings or anything else.)

The\,\verb|.dtx| file may itself be processed by \LaTeX{} to
produce a formatted (somewhat `literate') source listing for those 
interested in the implementation of the \TUB\ macros.

\section{The general structure of a paper}

The basic idea is to start your \LaTeX\ document with
\path|\documentclass{ltugboat}|, which defines the appearance of \TUB\
articles.  This uses the file \path|ltugboat.cls| as usual.

Each paper, therefore, is written as a document that may stand on its
own. It starts with a \cs{documentclass} command, and its body is
enclosed in a \envname{document} environment. There are some options to
the document class, described in the next section, but ordinarily the
author needn't bother with them. The defaults are designed for creating
proof copies of papers.

The proof output differs from the final production output with respect
to page numbers and other material.  The changes required for final
production are the responsibility of the \TUB{} editors; authors will
see the final version in proof.

In general, we have sought simply to keep to the spirit of \LaTeX\ in
the commands provided by the \TUB\ class (\verb|ltugboat|). On the
whole, the new \clsname{ltugboat} macros define \LaTeX{} commands and
environments, or modify the definitions of \LaTeX{} standard commands.
For those interested, section~\ref{sec:equiv} lists equivalences between
macros defined by the `plain' package \cite{Whitney:TB10-3-378} and
those defined by the new package.

\subsection{Class options for \clsname{ltugboat}}
\label{sec:boat-opts}

The \clsname{ltugboat} class accepts many of the options of the
\clsname{article} class (it suppresses the font-size selection and
one/two-side options). Normally there is no need to use any document
option. They are listed here for completeness.

\begin{optlist}
\item[draft] Set up for a draft copy of a paper (this is the default
  setting\Dash the author need not explicitly set it): page numbering
  starts at a high number, black marks for overfull boxes.
\item[extralabel] Use the extra label-distinguishing mark in the body
  of the reference; see section~\ref{sec:biblio}.
\item[final] Set up for the final copy of a paper: page numbering to
  come from elsewhere, no cropmarks.
\item[harvardcite] Specify Harvard-style citation. Not 
  recommended in general; see section~\ref{sec:biblio}.
\item[noextralabel] Don't use the extra mark for distinguishing labels in
  the body of the reference; see section~\ref{sec:biblio-harvard}.
\item[nonumber] Sections are not numbered; section heading
  layout is to be as in the `plain' \pkgname{tugboat} styles.
\item[numbersec] Sections, subsections and subsubsections are to be
  numbered (this is the default setting\Dash the author need not
  explicitly set it).
\item[onecolumn] Typeset article in one column.
\item[preprint] Set up for a preprint.
\item[rawcite] Explicitly specify the standard \LaTeX\ citation method,
  which is the default; see section~\ref{sec:biblio}.
\item[runningfull] Information in both header and footer (default).
\item[runningminimal] Information in header only.
\item[runningoff] Information in neither header nor footer.
\item[secondcolstart] Start the article in the second column.
\end{optlist}

\subsection{Use of packages}

Being a \TeX\ journal, authors may use both standard and non-standard
external packages for their articles. The overriding criterion is that
articles need to be processable on the \TUB{} production computers
(running current \TeX\ Live). A sensible mechanism for submitting
personal packages is by use of the \envname{filecontents} environment.
It's also fine to submit manuscript source with additional packages in a
zip or other archive.

In general, packages currently on \CTAN, and known to work with
\emph{current} \LaTeX{} are likely to be fine. In particular, \TUB\ is
happy to accept papers using packages that are supported by members of
the \LaTeX\ team.

\tug{} has a policy that macro packages described in \TUB{} should be
available for readers to use. Since typing macros from printed sources
is tedious, authors of publicly available packages are urged to submit
their macros to \CTAN{}. If a package is only available under restricted
terms, authors are requested to make this fact clear when first
submitting an article to the editor.

The \texttt{ltugboat} class loads the package \path|mflogo.sty|
\cite{Vieth:mflogo:1995} for typesetting the \MF\ logo. If this package
is not present by some mischance, \texttt{ltugboat} will emulate it.

Although not necessarily recommended in all cases, many additional
packages are commonly used. To mention a few:
\begin{description}
\item[microtype] can help reduce overfull boxes and improve appearance
(\verb|\usepackage{microtype}|);
\item[hyperref] supports live and internal hyperlinks, outlines, and
much more\\(\verb|\usepackage[hidelinks,pdfa]{hyperref}|).
\end{description}

\subsection{Titles, addresses and so on}

The title and author(s) of a paper are quoted using commands that are
familiar (in syntax, at least) to most \LaTeX{} users; the \cs{title}
command is exactly that used in the standard \LaTeX{} classes.  There is
also \cs{shortTitle\char`{\meta{your-short-title}\char`}} to define the form
used in running heads or footers; similarly \cs{shortAuthor}.

The \cs{author} command is used once for each co-author of the paper,
and for each \cs{author} there should be a \cs{address} command that
gives a (postal) correspondence address. In addition (wherever
possible), \TUB{} likes to quote an email address for authors: for this,
the \cs{netaddress} command is used. Each author may also mention a web
page, using a \cs{personalURL} command, and an \acro{ORCID} (from
\url{orcid.org}), using \cs{ORCID}.

For example, the present paper has (approximately) this at its start:

\begin{verbatim}[\small]
\title{The \LaTeXe\ \TUB{} Macros}
\author{TUGboat editors}
\address{\TeX\ Users Group}
\netaddress{tugboat@tug.org}
\personalURL{https://tug.org/TUGboat}
\maketitle
\end{verbatim}

Lines in the title information can get quite long.
If the information being given is
to be typeset as ordinary text (as in the case of the \cs{address}
line above), it can be `wrapped' perfectly happily, as in normal text.
If one of the verbatim items (\cs{netaddress} or \cs{personalURL}
commands) is going to be too wide for the column, what is the author
to do?  (Abbreviating the text, as in the \cs{personalURL} above, is
\emph{not} usually an acceptable option!)  Unfortunately, the \verb|%|
sign is an entirely acceptable element of both email addresses and
\acro{URL}s, so that the normal `fall-back' isn't available.
Therefore, the classes typeset these electronic addresses in an
environment where some of the characters (notably `\verb|.|' and
`\verb|/|') are treated as word-divisions for the purposes of laying
out the line.

If the paper is the result of more than one author's labours, a sequence of
\cs{author}, \cs{address}, \cs{netaddress} and \cs{personalURL}
commands may be given, as in the following, which comes from a paper
given at \tug'95 (abbreviated):

\begin{verbatim}[\small]
\author{Michel Goossens}
\address{CN Division, CERN\\
  ...}
\netaddress{...}

\author{Sebastian Rahtz}
\address{Elsevier Science Ltd\\
  ...}
\netaddress{...}
...
\end{verbatim}

The class files will take care of arranging author names and addresses
between the \cs{maketitle} and (possibly) \cs{makesignature} commands.

\subsubsection{Compilation articles}

Compilation articles are written as a set of contributed parts under the
general editorship of the author(s) of the article. The author of the
article is presented (using \cs{author}, etc.)\ in the
usual way, and writes the introductory text. Each contributors' part
then follows. The contributor's name is quoted in the \cs{contributor}
command, which is an analogue of the \cs{author} command; contributors'
\cs{address}, \cs{netaddress} or \cs{personalURL}. The \cs{contributor}
command opens a group in which the contribution appears, and the
contributor's signature (produced with a \cs{makesignature} command)
closes the group. The general scheme looks like:
\begin{verbatim}[\small\makeescape\|\makebgroup\[\makeegroup\]]
\title{Example compilation article}
\author{Robin Fairbairns}
\address{University of Cambridge ...}
\netaddress{...}
 ... |textsl[introductory text] ...
\makesignature

\contributor{Betsy the Dog}
\address{Romsey Town, Cambridge}
 ... |textsl[Betsy's contribution] ...
...
\makesignature ...
\end{verbatim}

\subsection{Divisions of the paper}
\label{sec:divs-paper}

Papers in \TUB{} may be subdivided in the normal way of a \LaTeX{}
article (the classes are defined in terms of \LaTeX{}'s
\clsname{article} class). Thus the author may use \cs{section},
\cs{subsection}, \dots, \cs{paragraph} commands (but \cs{part} and
\cs{subparagraph} from \clsname{article} are suppressed, and
\cs{chapter}, which does not even appear in the parent class, receives
the same treatment).

Authors may note that the style of ordinary issues of \TUB{} makes
no distinction between the titles of the divisions; the visual style
relies on the section numbers to indicate where the divisions lie in
the hierarchy.  If you use \cs{paragraph}, consider ending the paragraph
label with a period; sometimes it is helpful, sometimes not.

For references to numbered sections, our style is to always use the word
`Section' in the text, e.g.,\\
\verb|Section~\ref{sec:whatever}|\\
without worrying about whether it is technically a sub(sub)section.
It's also ok to use the section sign~\S{}, if that suits the material
better.

Reference can also be made to the `title' of divisions of the paper,
whether they are numbered or not. The \cs{nameref} command (which uses
the technique developed for the \tbcode{hyperref} package
\cite{Rahtz:hyperref:1997}) permits such references; for example, the
present section was introduced by:
\begin{verbatim}[\small]
\section{Divisions of the paper}
\label{sec:divs-paper}
\end{verbatim}
and the command \verb|\nameref{sec:divs-paper}| produces
`\nameref{sec:divs-paper}'. However, as you can see here, reusing the
literal text of section titles often results in awkward results. We
recommend numbered references in general.

\subsubsection{Abstracts}

The \clsname{ltugboat} class provides two environments for abstracts.
The \envname{abstract} environment simply typesets its body as an
unnumbered section whose title is `Abstract'. The \envname{longabstract}
environment typesets its body in small text, and separates the abstract
from the rest of the paper with a decorative line; this is rarely used.

Please write an abstract, however short.

\subsubsection{Appendices}

A paper may have appendices, which can be expressed in exactly the same
way as they would be in the \LaTeX{} article class (confusing as that
may be):

\begin{verbatim}[\small]
\appendix
\section{This is appendix A}
...
\section{This is appendix B}
\end{verbatim}
Which will produce `section' headings similar to:
\begin{quote}
\textbf{A\quad This is appendix A}
\end{quote}

\TUB{} articles may have a small extension to this format using an
\texttt{appendix} environment:

\begin{verbatim}[\small]
\begin{appendix}
\section{This is the first one}
...
\end{appendix}
\end{verbatim}
which will produce `section' headings similar to:
\begin{quote}
\textbf{Appendix A\quad This is the first one}
\end{quote}

In both cases, the subsections are numbered as normal (i.e., as
`A.\ensuremath{n}' in normal \TUB{} papers):

\section{Floating inserts}

The classes do not make any change to \LaTeX{}'s built-in provision for
floating inserts, so that authors should write figures and tables as usual,

The default is for floats to be the width of the column. To make a float
which is the width of the whole page, use \envname{figure*} and
\envname{table*}.

Regarding caption placement, \TUB's convention is to put captions for
figures below the figure, but captions for tables and listings above the
table\slash listing. Please follow this convention unless there is a
specific reason not to.

As a reminder, \cs{label} commands should always follow the
\cs{caption}.

\section{Special-purpose typesetting}

The classes define a rather large set of commands for special-purpose
typesetting.

\subsection{Assorted simple markup}

A short list of commonly-needed special typesetting commands follows; a
larger set of such commands is defined in the classes. Feel free to peruse.

\begin{cmdlist}\raggedright
\item[\cs{cmd}] Typeset a control sequence name:\\
  \verb|\cs{fred}| produces \cs{fred}.

\item[\Dash] Typeset an em-dash, ignoring preceding and following space,
  surrounded by thin spaces, only breakable after the dash; this
  is our preferred method of specifying an em-dash in running text, over
  \texttt{---} or (especially) the Unicode character(s).

\item[\meta{var}] Typeset meta-syntactic text:\\
  \verb|\meta{fred}| produces \meta{fred}.

\item[\tbcode{text}] Literal text, such as class names, package names,
filenames, environment variables, etc. The text is typeset in typewriter
and is not breakable.

\item[\tbcodebreak{text}] Like \cs{tbcode}, but breakable as with urls,
e.g., at periods. Still not hyphenated.

\item[\tubbraced{text}] Typeset typewriter text in typewriter
  braces: \verb|\tubbraced{fred}| produces \tubbraced{fred}.
\end{cmdlist}
For commands to typeset urls, see section~\ref{sec:urls}.

\subsection{Acronyms and logos}

The classes provide macros that produce `correct' representations of a
large number of acronyms and logos; a small representative selection is
shown in figure~\ref{fig:acro-logo}.  The sample documents at
\url{tug.org/TUGboat/location.html} have a more complete list,
and of course the class sources are the ultimate reference.
\begin{figure}[htbp!]
  \begin{center}
    \begin{tabular}{@{}ll@{}}
      \small\textsl{\tbcode{Macro}}&\small\textsl{\tbcode{Output}}\\
      \midrule
      \verb|\ConTeXt|   & \ConTeXt \\
      \verb|\Cplusplus| & \Cplusplus \\
      \verb|\CTAN|   & \CTAN \\
      \verb|\eTeX|   & \eTeX\\
      \verb|\FAQ|    & \FAQ \\
      \verb|\HTML|   & \HTML \\
      \verb|\ISBN|   & \ISBN \\
      \verb|\KOMAScript| & \KOMAScript \\
      \verb|\LaTeXe| & \LaTeXe \\
      \verb|\macOS|  & \macOS \\
      \verb|\MathML| & \MathML \\
      \verb|\MF|     & \MF \\
      \verb|\PDF|    & \PDF \\
      \verb|\SGML|   & \SGML \\
      \verb|\TUB|    & \TUB \\
      \verb|\TUG|    & \TUG \\
      \verb|\tug|    & \tug \\
      \verb|\XML|    & \XML \\
    \end{tabular}
  \end{center}
  \caption{A few of the provided acronyms and logos}
  \label{fig:acro-logo}
\end{figure}

Authors are especially urged to note the \cs{acro} command, which is
defined in the classes. The visual appearance of all-caps sequences
among normal text is rather unpleasing in Computer Modern,
unfortunately. Therefore, the \cs{acro} command typesets its argument
one point size smaller than the surrounding text: compare `\acro{DANTE}'
(\verb|\acro{DANTE}|) with `DANTE'\@. Many of the provided macros merely
generate calls to \cs{acro}; two examples, \cs{CTAN} and \cs{tug} of the
list in figure~\ref{fig:acro-logo} have already been used in the present
paper.

\subsection{Verbatim text}
\label{sec:verbatim}

For inline verbatim text, authors should ordinarily employ the
facilities of \LaTeX{} itself, that is, the \cs{verb} macro.  This macro, of
course, is highly restricted as to its usage\Dash primarily, it may
not appear in the argument of \emph{any} other macro, even
\cs{footnote}.

For displayed verbatim text, the classes add a small increment to
the functionality of \LaTeX{}'s \envname{verbatim} environment, by
introducing an optional argument.  The optional argument may contain
commands to be executed before starting the verbatim text; the set of
commands which have useful effect is strictly limited, but the
following are common:
\begin{itemize}
\item Font size selection commands: for example, all the display
  verbatim in the present paper starts with
  \verb|\begin{verbatim}[\small]|.

\item The command \cs{ruled}, which is available \emph{only} in
  \envname{verbatim}'s optional argument, and specifies that a
  column-wide rule should be drawn before and after the verbatim
  text. (This is not the recommended style in general, but it's
  available for when it helps.)

\item The command \cs{makevmeta}, also available only in
  \envname{verbatim}'s optional argument, and makes the construct
  \verb|!<...>| inside verbatim execute \verb|\meta{...}|. For example,
\begin{verbatim}[\small] 
\begin{verbatim}[\small\makevmeta]
The !<duration> is long ...
\end{verbatim}
produces:
\begin{verbatim}[\small\makevmeta]
The !<duration> is long ...
\end{verbatim}
  The \verb|!| character is made a general escape character by
  \cs{makevmeta}, but \verb|<>| are not made grouping characters.

\item More generally, one of the \cs{make*} commands,\footnote{\cs{makeescape},
  \cs{makebgroup}, \dots, \cs{makecomment}; used, for example, as
  \cs{makeescape}\cs{|}.} which change the category code of
  characters within the verbatim text.  This is (of course) a facility
  that should only be used with the utmost caution.

\end{itemize}
Two caveats about these optional arguments:
\begin{itemize}
\item The search for the optional argument can be confused by the
  appearance of a \verb|[| character as the first character of the displayed
  verbatim.  An author who wishes to start verbatim text with a
  \verb|[| character should provide an empty optional argument (i.e.,
  `\verb|[]|') to the \envname{verbatim} environment.
\item The \TUB\ facility is lost when any package is loaded that also
  defines the \verb|verbatim| environment, as discussed next.
\end{itemize}

Authors may wish to use a more featureful verbatim package, such as
\pkgname{listings}~\cite{pkg:listings} or
\pkgname{fancyvrb}~\cite{pkg:fancyvrb}. This is ok; it just means the
\TUB\ optional-argument feature is not available. On the other hand,
please do not use the \pkgname{minted} package if possible; it is harder
to customize and correct at the \TeX\ level, and the shell escape
requirement is troublesome. In any case, we will almost always wish to
print code listings in straight black, not colored or even grayscaled.

If you use the \pkgname{listings} package, please set:
\begin{verbatim}[\small]
\lstset{columns=fullflexible,
  keepspaces=true,
  commentstyle=\slshape,
  basicstyle=\ttfamily
             \lst@ifdisplaystyle\small\fi,}
\end{verbatim}
Explanations:
\begin{itemize}
\item \texttt{columns=fullflexible}:
The other values for the \verb|columns| option don't work well in \TUB;
we want the program text to be typeset normally, not forcibly aligned
into large character cells.

\item \texttt{keepspaces=true}:
However, having flexible columns makes spaces in the input not
necessarily correspond to spaces in the output. That's usually desired,
for alignment of the sources, hence \texttt{keepspaces}.

\item \texttt{commentstyle=\cs{slshape}}:
We prefer slanted to Computer Modern typewriter italic.
Using regular upright typewriter for comments is fine too.

\item \texttt{basicstyle=...}:
We usually prefer \cs{small} for displayed verbatim, but not inline
verbatim, hence the conditional.

\end{itemize}

\subsection{Typesetting urls}
\label{sec:urls}

In short:

\begin{enumerate}
\item Please load either the \texttt{url} or (preferably) the
\texttt{hyperref} package so that reasonable line breaking of urls can
happen.

\item Add \verb|\def\url{\tburl}| to your preamble and use \cs{url} in your
document as usual. (It seems too intrusive for the \TUB\ classes to
redefine something as fragile and widespread as \cs{url}.)
\end{enumerate}
The rest of this section is more details about the above.

The main reason for preferring the above is that for the printed
(visible) \TUB\ page, nowadays we typically prefer to omit a leading
\texttt{https://}. But for the link to actually work in the output \PDF\
or \HTML, the protocol is required (else the \PDF\ reader thinks it is
a local filesystem path). Therefore the \texttt{ltugboat} class provides
(as of 2023) the command \cs{tburl} for this.\footnote{This and related
commands are wrappers around \cs{hyper@linkurl}.
Thanks to Ulrike Fischer for doing the real work:
\tburl{https://github.com/latex3/hyperref/issues/125}\raggedright}

For example, the commands \verb|\tburl{tug.org}| and
\verb|\tburl{https://tug.org}| both typeset the text `\texttt{tug.org}'
(with the usual url line breaks possible) as a link to
\url{https://tug.org}.

Since so few web sites do not support https,
\verb|\tburl{http://example.org}| typesets the full url as text
`\texttt{http://example.org}' as a link to itself.  If it's desirable to
elide the http://, the variant \cs{tbhurl} can be used.

Thus, as shown, the correct protocol can be explicitly specified, and
will be stripped for display. Just use \cs{tburl}.

In short, \cs{tburl} and related make live links and omit the protocol
if \pkgname{hyperref} is loaded. We highly recommend this.

Without \texttt{hyperref}, they are merely synonyms for \cs{url}. This
is ok, and we still request that the protocol not be included; if live
links are not being produced in the output, the printed url without the
protocol suffices. (When a user copies/pastes url text into a browser,
it will normally work.)

In order to keep using \cs{url} in a document body, we suggest
\verb|\def\url{\tburl}|.

For \texttt{ftp}, \texttt{rsync}, and other protocols, it is best to
always include them explicitly and use \cs{url}:\\
\verb|\url{ftp://tug.org}|,\\ \verb|\url{rsync://tug.org}|, etc.

Finally, sometimes it is best to allow line breaks at hyphens in urls.
We've found that this is not confusing in practice.  To enable this and
\pkgname{hyperref} at the same time, it's necessary to load
\pkgname{url} explicitly and enable the \tbcode{hyphens} option: 

\begin{verbatim}
\usepackage[hyphens]{url}
\usepackage[hidelinks]{hyperref}
\end{verbatim}

\subsubsection{Url footnotes}
\label{sec:urlfootnotes}

The shortcut macro \cs{tburlfootnote} makes a ragged-right footnote
using the \cs{tburl} command. We recognize that when writing url
references, sometimes the best option is to put urls in footnotes.

However, when it's sensible, we prefer to have urls as either
parentheticals in the main text or in bibliography entries, to ease page
breaking and reading flow. It is ideal to minimize\slash avoid footnotes
in general.

\subsubsection{Url shortcuts}
\label{sec:urlshortcuts}

A different aspect of urls: the \tug\ web server supports a shortcut url
mechanism, \url{tug.org/l/}\meta{ident}, where \meta{ident} can be any
tag, similar to \url{tinyurl.com} and similar sites. The idea is that
\url{tug.org} shortcuts can be used in \TUB\ articles needing to link to
excessively long and/or unstable web resources; then we update the
shortcut if needed, and not worry that a commercial shortcut provider
will disappear.

The only way to create a \url{tug.org/l/} shortcut is by request, which
we are happy to receive.

\section{Bibliographies}
\label{sec:biblio}

In short: our basic recommendation for handling bibliographies is to use
\BibTeX\ and the \pkgname{tugboat} bibliography style. No document
options are needed or recommended. All that is required in the article
source (as in the template available from \url{tug.org/TUGboat}) is the
following:

\begin{verbatim}[\small]
\bibliographystyle{tugboat}
\bibliography{yourbibfile}
\end{verbatim}

If you use \BibTeX, feel free to take advantage of the accumulated
bibliography of \TUB{} itself
(\url{mirror.ctan.org/info/biblio/tugboat.bib} on \CTAN, also in \TeX\
Live, etc.), and the other compilations by Nelson Beebe in that same
directory.

If you don't have \verb|tugboat.bst| (our \BibTeX\ style file), which
was released in 2018, it's fine to use \pkgname{plain} or
\pkgname{abbrv}. If you do have it, though, you may enjoy the following
small but useful features:

\begin{itemize}
\item It is based on \pkgname{abbrvurl.bst} (see \url{ctan.org/pkg/urlbst}),

\item and thus supports \tbcode{url} and \tbcode{doi} fields, among others.
Please use \tbcode{url} instead of putting urls in the
\tbcode{note} field, where possible. Also, please don't bother to
include ``access date'' information for \TUB; we find that extraneous.

\item The \tbcode{url} field is ignored if either the \tbcode{doi} or
\tbcode{howpublished} field is present. In practice we observe that
people put the same information in all those fields, and we don't want
to typeset redundant information.

\item Does even more abbreviating than \tbcode{abbrv}, such as
printing only two author names (plus ``et~al.'')\ if there are more than
four authors (thanks to Mico Loretan and Oren Patashnik).

\item New field \tbcode{bookauthor} for the \tbcode{@incollection} and
\tbcode{@inproceedings} allows for citing a part, written by author~X,
of a publication written by author~Y, and not just edited by~Y.

\item For the \tbcode{@misc} entry type, \tbcode{editor} is accepted as
well as \tbcode{author}.

\item Defines entry types \tbcode{@online} and \tbcode{@software} as
aliases for \tbcode{@misc}.

\item Defines an \tbcode{@ctan} entry type to reference packages on
\CTAN, following the fields output by the \pkgname{ctanbib} script (in
the package of the same name, \url{ctan.org/pkg/ctanbib}).

\item For completeness only: \verb|tugboat.bst| provides several 
fields intended to be used by the editors:
\begin{description}\raggedright
\item[\sf journaltie] to output
  a tie instead of space after the \tbcode{journal} value,
\item[\sf monthtie] for the same after \tbcode{month},
\item[\sf newpage] to force a page break after the current item,
\item[\sf nowarning] to omit empty field warnings, \tbcode{prebibitem} to
  output material before \cs{bibitem} (e.g., a section heading),
\item[\sf pagesnodashify] to avoid autoconverting \texttt{-} to
  \texttt{--} in the \texttt{pages} field,
\item[\sf urlnewline] to force a line break before the \tbcode{url} value.
\end{description}
As editors, we've found that these presentation tweaks can be desirable
for the final typeset output. Authors need not worry about them.

\end{itemize}

By the way, we recommending using commas to terminate all fields in
\texttt{.bib} files, including the last one in an entry. That makes for
one less thing to worry about when changing fields in the source.

Bibliographies can be difficult to typeset at the best of times.
\LaTeX{} sets \cs{sloppy} when typesetting the bibliography, but this
typically leads to unpleasant output with \TUB's narrow columns. The
author can specify typesetting parameters using the command
\cs{SetBibJustification}. The classes remain \cs{sloppy} by default, but
this can be changed with (for example),
\begin{verbatim}
  \SetBibJustification{\raggedright}
\end{verbatim}
as the present article does, to often achieve somewhat better results.

Multiple citations: when citing more than one item, please include them
in a single \cs{cite} command, as in \verb|\cite{foo,bar}|. Also, please
ensure that the result is in numerical order, so if \texttt{foo} ends up
as reference `[2]' and \texttt{bar} as `[1]', use \verb|\cite{bar,foo}|.

One more note on references: for \TUB\ issues, please use the format
\textsl{volno\,:\,issno}, e.g., ``\TUB\ 32:1'' for volume~32, number~1.

\subsection*{Non-recommended bibliography facilities}
\label{sec:biblio-harvard}

The preceding gives the bibliography recommendations for current \TUB\
articles. If, for whatever reason, you do not wish to follow those
recommendations, this section is about some of the myriad historical and
other possibilities.

Notwithstanding that general recommendation for the \pkgname{tugboat}
(falling back to \pkgname{plain}) \BibTeX\ style, \TUB's Harvard-style
citation support may be selected by specifying \optname{harvardcite} as
an option of the \cs{documentclass} command.\footnote{%
  The macros used derive rather directly from the `harvard' styles
  written by Glenn Paulley and later maintained by Peter Williams; the
  \BibTeX{} style derives from one developed by Patrick Daly.}
If your article demands Harvard-style citations, you may prefer to load
\pkgname{natbib} or similar instead of using \TUB's facilities; that's
fine.

This basic citation format is `author(s), year', but the macros are
capable of many variations. This in turn places somewhat of a load on
the author to use the correct citation macro. The macros available are
shown in figure~\ref{fig:citation-macros}; the figure assumes an entry
in the bibliography with authors Tom, Dick, and~Harry, and with a 1990
date.

\begin{figure}[htbp!]
  \begin{center}
    \leavevmode
    \begin{tabular}{@{}ll@{}}% @{ $\rightarrow$ } between columns removed
      \small Macro & Output\\
      \midrule
      \verb|\cite{key}|       & (Tom, Dick, and Harry, 1990)\\
      \verb|\citeA{key}|      & (Tom, Dick, and Harry)\\
      \verb|\citeNP{key}|     & Tom, Dick, and Harry, 1990\\
      \verb|\citeANP{key}|    & Tom, Dick, and Harry\\
      \verb|\citeN{key}|      & Tom, Dick, and Harry (1990)\\
      \verb|\shortcite{key}|  & (Tom et al., 1990)\\
                              & [also has \texttt{A} and \texttt{NP}
                                 variants]\\
      \verb|\citeyear{key}|   & (1990)\\
                              & [also has an \texttt{NP} variant]
    \end{tabular}
  \end{center}
  \caption{The range of citations in \optname{harvard} style}
  \label{fig:citation-macros}
\end{figure}

Furthermore, if Tom, Dick, and Harry are a prolific team, there can
easily be more than one reference to their work in one year.  In such
a case, the citations will be (Tom, Dick, and Harry, 1990a), (Tom,
Dick, and Harry, 1990b), and so on.  These extra `a', `b', etc., tags
may also appear in the references section of the paper, attached to
the year recorded for the reference: whether this indeed happens is
controlled by the \optname{extralabel} and \optname{noextralabel} class
options.  The default state (option \optname{extralabel}) attaches the
extra characters.

As for \BibLaTeX: we don't recommend it for \TUB. If you feel you must
use it, that is ok, but we may still change it to using the default
\LaTeX\ and \BibTeX\ facilities in processing for publication if the
output from \BibLaTeX\ is problematic, as we have often seen it to be.

%\appendix
\section{Equivalences between the `plain' and \LaTeX{} \TUB\ packages}
\label{sec:equiv}

A good proportion of the commands in the `plain' packages also appear
(with the same meaning) in the \LaTeX{} classes.
Figure~\ref{fig:plain-equiv} gives a brief summary of where the macros
differ significantly.

\begin{figure}[htbp]
  \begin{center}
    \leavevmode
    \begin{tabular}{@{}ll@{}}
      \small Plain macro & \small \LaTeX{} macro \\
      \midrule
      \cs{head} & \cs{section} \\
      \cs{subhead} & \cs{subsection} \\
      \cs{subsubhead} & \cs{subsubsection} \\
      \cs{list} & \envname{itemize}, \envname{enumerate}, etc., \\
                & environments \\
      \cs{verbatim} & \envname{verbatim} or \cs{verb} \\
      \cs{figure}   & \envname{figure} or \envname{figure*} environments \\
    \end{tabular}
  \end{center}
  \caption{Equivalences between \pkgname{plain} and \LaTeX{} \TUB\ macros}
  \label{fig:plain-equiv}
\end{figure}

\LaTeX{} itself makes comprehensive provision for lists; the \TUB{}
classes make no attempt to emulate the list facilities of the `plain'
macros.

The `plain' styles' provision for verbatim text is also somewhat
different from the \LaTeX{} approach; the \TUB{} classes offer a small
subset of the extra facilities that the `plain' styles provide; for more
elaborate facilities, the user is referred to the \pkgname{verbatim},
\pkgname{listings}, and \pkgname{fancyvrb} packages (see
section~\ref{sec:verbatim}).

The syntax of commands given to the \LaTeX{} classes is different;
arguments are (almost always) enclosed in braces instead of the various
forms provided by the `plain' macros.

\SetBibJustification{\raggedright}
\bibliographystyle{tugboat}
\bibliography{tubguide}

\advance\signaturewidth by 8pt
\makesignature

\end{document}
